# Chapter 4.Retirement

- 이번 장에는 메서드 결과로 반환되는 NULL, 예외 처리, 리소스 획득에 관해 살펴본다.

### 1. 절대 NULL을 반환하지 마세요

- 객체라는 사상에는 우리가 **신뢰**하는 엔티티라는 개념이 담겨져 있다.
- 객체는 자신만의 생명주기, 자신만의 행동, 자신만의 상태를 가지고 살아있는 유기체이다.
- **신뢰**라는 말은 **객체 자신의 행동을 전적으로 책임**지고 우리가 어떤 식으로든 간섭하지 않는다 의미가 담긴다.
- 객체에게 아무런 말도 하지 않은 채 우리 마음대로 예외를 던져서는 안된다. 이러한 방식완 완전히 잘못됐고 **무례**하다.
  ````java
  if(title == null){
    throw new Exception();
  }
  ````
- 반환값을 검사하는 방식은 애플리케이션에 대한 신뢰가 부족하다는 명백한 신호이다.

1) 빠르게 실패하기 vs 안전하게 실패하기

- **빠르게 실패하기** : 어떤 문제가 발생하면 곧바로 실행을 중단하고 최대한 빨리 예외를 던진다.
    - 모든 실패 지점이 명확하다. 실패를 눈에 잘 띄게 만들고 추적하기 쉽게 만든다.
- 안전하게 실패하기 : 어떤 상황이 닥치더라도 소프트웨어는 생존하기 위해 노력(값이 없다면 null을 리턴한다 등..)
    - 실패 시점이 추적하기 어려워진다.

2) NULL의 대안

- 빈 컬렉션을 반환한다.
  ````java
  public Collection<User> users(String name){
    if(/* 데이터베이스에서 발견하지 못했다면 */){
        return new ArrayList<>(0);
    }
    return Collections.singleton(/* 데이터베이스로부터 */);
  }
  ````
- Optional은 콜렉션과 동일하지만, OOP와 대립한다고 생각하며 사용을 권하지 않는다.
- **널 객체 디자인 패턴**을 사용한다.
    - 겉으로 보기에는 원래의 객체처럼 보이지만, 실제로는 다르게 행동하는 객체를 반환한다.
  ````java
  class NullUser implements User{
    private final String label;
    NullUser(String name){
        this.label = name;
    }
    @Override
    public String name(){
        return this.label;
    }
    @Override
    public void raise(Cash salary){
        throw new IllegalArgumentException(
            "봉급을 인상할 수 없습니다. 스텁 객체입니다."
        );
    }
  }  
  ````
- **절대로 NULL을 반환하지 마세요**. NULL 대신 **예외를 던지거나**, **컬렉션을 반환**하거나, **널 객체**를 반환하세요.

### 2. 체크 예외(checked exception)만 던지세요

### 3. final이나 abstact이거나

### 4. RAII를 사용하세요
